#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ”’ Running SafeSpot Security Checks..."

# Check for ESLint errors
cd server || exit 1

echo "ğŸ“‹ Checking ESLint rules..."
npm run lint || {
    echo "âŒ ESLint failed. Fix errors before committing."
    echo "ğŸ”§ Run: npm run lint:fix"
    exit 1
}

echo "ğŸ” Running security audit..."
npm run security:audit || {
    echo "âŒ Security audit failed. Fix violations before committing."
    exit 1
}

echo "ğŸ“¦ Running npm audit..."
npm audit --audit-level=moderate || {
    echo "âš ï¸ Security vulnerabilities found. Review before committing."
    exit 1
}

echo "âœ… All security checks passed!"
