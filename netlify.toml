[build]
  command = "npm install --legacy-peer-deps && npm run build"
  publish = "dist"

  NODE_VERSION = "18"
  NPM_FLAGS = "--legacy-peer-deps"

# ===============================================
# SOCIAL SHARE PROXY
# This rule proxies crawlers/users hitting /reporte/* 
# to the backend so they get the Open Graph HTML.
# The backend then redirects real users back to /reporte/:id (here).
# ===============================================
[[redirects]]
  from = "/reporte/*"
  to = "https://safespot-backend.onrender.com/reporte/:splat"
  status = 200
  force = true

# ===============================================
# SPA FALLBACK
# For all other routes, serve index.html
# ===============================================
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
